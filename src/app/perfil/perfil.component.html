<app-header></app-header>

<main class="perfil-container">

    <section class="perfil-banner">
        <div class="info-usuario-banner">
            <img [src]="meuPerfil.fotoUrl" alt="Foto de Perfil" class="avatar-grande">
            <div class="textos-banner">
                <h1>{{ meuPerfil.nome }}</h1>
                <p>{{ meuPerfil.profissao }}</p>
            </div>
        </div>

        <div class="card-recompensas">
            <div class="moedas-info">
                <span class="icone-moeda">ü™ô</span>
                <span class="valor-moedas">{{ meuPerfil.moedas || 0 }}</span>
            </div>
            <p class="label-moedas">Moedas Indie</p>
            <button class="btn-recompensa">üéÅ Recompensa Di√°ria</button>
        </div>
    </section>


    <section class="perfil-conteudo">
        <div class="cabecalho-conteudo">
            <h2>Informa√ß√µes do Perfil</h2>
            <button class="btn-editar-roxo" (click)="abrirModalEdicao()">Editar Perfil</button>
        </div>

        <div class="grid-informacoes">
            <div class="coluna-info">
                <h3>Informa√ß√µes B√°sicas</h3>
                
                <div class="item-info">
                    <label>E-mail:</label>
                    <p>{{ meuPerfil.email }}</p>
                </div>
                
                <div class="item-info" *ngIf="meuPerfil.localizacao">
                    <label>Localiza√ß√£o:</label>
                    <p>{{ meuPerfil.localizacao }}</p>
                </div>

                <div class="item-info" *ngIf="meuPerfil.biografia">
                    <label>Biografia:</label>
                    <p class="texto-bio">{{ meuPerfil.biografia }}</p>
                </div>
                
                <div class="item-info" *ngIf="meuPerfil.experiencia">
                    <label>Experi√™ncia:</label>
                    <p>{{ meuPerfil.experiencia }}</p>
                </div>
                
                <div class="item-info" *ngIf="meuPerfil.portfolio">
                    <label>Portfolio:</label>
                    <a [href]="meuPerfil.portfolio" target="_blank" style="color: #9333EA; text-decoration: none;">Acessar Portfolio</a>
                </div>
            </div>

             <div class="coluna-info">
                <h3>Links Sociais</h3>
                <div class="lista-links">
                    <a *ngIf="meuPerfil.linksSociais.github" [href]="meuPerfil.linksSociais.github" target="_blank" class="link-social">GitHub üîó</a>
                    <a *ngIf="meuPerfil.linksSociais.linkedin" [href]="meuPerfil.linksSociais.linkedin" target="_blank" class="link-social">LinkedIn üîó</a>
                    <a *ngIf="meuPerfil.linksSociais.twitter" [href]="meuPerfil.linksSociais.twitter" target="_blank" class="link-social">Twitter üîó</a>
                    <a *ngIf="meuPerfil.linksSociais.website" [href]="meuPerfil.linksSociais.website" target="_blank" class="link-social">Website üîó</a>
                    
                    <p *ngIf="!meuPerfil.linksSociais.github && !meuPerfil.linksSociais.linkedin && !meuPerfil.linksSociais.website" style="color: #9ca3af; font-style: italic;">
                        Nenhum link social adicionado.
                    </p>
                </div>

                <h3 style="margin-top: 30px;">Habilidades</h3>
                <div class="tags-visualizacao">
                    <span class="tag-skill" *ngFor="let skill of meuPerfil.habilidades">{{ skill }}</span>
                    <p *ngIf="meuPerfil.habilidades.length === 0" style="color: #9ca3af; font-style: italic;">
                        Nenhuma habilidade selecionada.
                    </p>
                </div>
            </div>
        </div>
    </section>

</main>


<div class="modal-overlay" *ngIf="modalAberto">
    <div class="modal-janela modal-largo">
        <div class="modal-header">
            <h2>Editar Perfil</h2>
            <button class="btn-fechar" (click)="fecharModal()">‚úñ</button>
        </div>

        <div class="modal-body">
            
            <div class="form-group" style="margin-bottom: 20px;">
                <label>URL da Foto de Perfil</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" [(ngModel)]="perfilEmEdicao.fotoUrl" placeholder="https://exemplo.com/minhafoto.jpg">
                    <img [src]="perfilEmEdicao.fotoUrl || 'https://via.placeholder.com/40'" 
                         alt="Preview" 
                         style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid #ccc;">
                </div>
                <small style="color: #6b7280; font-size: 0.8rem;">Cole o link de uma imagem da internet.</small>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Nome</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.nome">
                </div>
                <div class="form-group">
                    <label>E-mail</label>
                    <input type="email" [(ngModel)]="perfilEmEdicao.email" disabled style="background-color: #f3f4f6; cursor: not-allowed; color: #6b7280;" title="O email n√£o pode ser alterado">
                </div>
            </div>

             <div class="form-row">
                <div class="form-group">
                    <label>Profiss√£o</label>
                    <select [(ngModel)]="perfilEmEdicao.profissao">
                        <option value="">Selecione</option>
                        <option *ngFor="let prof of listaProfissoes" [value]="prof">{{ prof }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Localiza√ß√£o</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.localizacao" placeholder="Cidade, Estado">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Experi√™ncia</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.experiencia" placeholder="ex: 3 anos">
                </div>
                <div class="form-group">
                    <label>Portfolio</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.portfolio" placeholder="https://meuportfolio.com">
                </div>
            </div>

            <div class="form-group">
                <label>Biografia</label>
                <textarea rows="4" [(ngModel)]="perfilEmEdicao.biografia" placeholder="Fale sobre voc√™..."></textarea>
            </div>

            <div class="form-group">
                <label style="margin-top: 20px; display: block;">Habilidades</label>
                <div class="tags-selecao-container">
                    <button 
                        type="button"
                        class="btn-tag-selecionavel" 
                        *ngFor="let skill of listaHabilidadesDisponiveis"
                        [class.selecionado]="habilidadeEstaSelecionada(skill)"
                        (click)="alternarHabilidade(skill)">
                        {{ skill }}
                    </button>
                </div>
            </div>

             <h3 style="margin-top: 30px; margin-bottom: 15px; color: #374151;">Links Sociais</h3>
             <div class="form-row">
                <div class="form-group">
                    <label>GitHub</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.linksSociais.github" placeholder="https://github.com/usuario">
                </div>
                <div class="form-group">
                    <label>LinkedIn</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.linksSociais.linkedin" placeholder="https://linkedin.com/in/usuario">
                </div>
             </div>
             <div class="form-row">
                <div class="form-group">
                    <label>Twitter/X</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.linksSociais.twitter" placeholder="https://twitter.com/usuario">
                </div>
                <div class="form-group">
                    <label>Website Pessoal</label>
                    <input type="text" [(ngModel)]="perfilEmEdicao.linksSociais.website" placeholder="https://meusite.com">
                </div>
             </div>

        </div>

        <div class="modal-footer">
            <button class="btn-cancelar" (click)="fecharModal()">Cancelar</button>
            <button class="btn-salvar-modal" (click)="salvarAlteracoes()">Salvar Altera√ß√µes</button>
        </div>
    </div>
</div>